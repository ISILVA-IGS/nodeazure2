<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>NexusTech</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
    <link rel="stylesheet" href="dist/css/skins/skin-blue.min.css">
    <meta name="author" content="Hcode.com.br" />
    <meta name="theme-color" content="#ADD8E6">
</head>

<body class="hold-transition skin-blue sidebar-mini">

  <div class="wrapper">

    <!-- Main Header -->
    <header class="main-header">

      <!-- Logo -->
      <a href="index.html" class="logo">
        <!-- mini logo for sidebar mini 50x50 pixels -->
        <span class="logo-mini">NexusTech</span>
        <!-- logo for regular state and mobile devices -->
        <span class="logo-lg">NexusTech</span>
      </a>

      <!-- Header Navbar -->
      <nav class="navbar navbar-static-top" role="navigation">
        <!-- Sidebar toggle button-->
        <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
          <span class="sr-only">Toggle navigation</span>
        </a>
        <!-- Navbar Right Menu -->
        <div class="navbar-custom-menu">
          <ul class="nav navbar-nav">
            <!-- User Account Menu -->
            <li class="dropdown user user-menu">
              <!-- Menu Toggle Button -->
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <!-- The user image in the navbar-->
                <img src="dist/img/avatar5.png" class="user-image" alt="User Image">
                <!-- hidden-xs hides the username on small devices so only the image appears. -->
                <span class="hidden-xs">Usuário</span>
              </a>
              <ul class="dropdown-menu">
                <!-- The user image in the menu -->
                <li class="user-header">
                  <img src="dist/img/avatar5.png" class="img-circle" alt="User Image">

                  <p>
                    Usuário
                    <small>contato@nexustech.com</small>
                  </p>
                </li>
                <!-- Menu Footer-->
                <li class="user-footer">
                  <div class="pull-left">
                    <a href="#" class="btn btn-default btn-flat">Perfil</a>
                  </div>
                  <div class="pull-right">
                    <a href="#" class="btn btn-default btn-flat">Sair</a>
                  </div>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar">

      <!-- sidebar: style can be found in sidebar.less -->
      <section class="sidebar">

        <!-- Sidebar user panel (optional) -->
        <div class="user-panel">
          <div class="pull-left image">
            <img src="dist/img/avatar5.png" class="img-circle" alt="User Image">
          </div>
          <div class="pull-left info">
            <p>Usuário</p>
            <!-- Status -->
            <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
          </div>
        </div>

        <!-- Sidebar Menu -->
        <ul class="sidebar-menu" data-widget="tree">
          <li class="header">MENU</li>
          <!-- Optionally, you can add icons to the links -->
          <li>
            <a href="index.html">
              <i class="fa fa-home"></i>
              <span>Tela Inicial</span>
            </a>
          </li>
          <li class="active">
                <a href="Monitoramento.html">
                  <i class="fa fa-circle"></i>
                  <span>Monitoramento</span>
                </a>
              </li>
              <li>
            <li>
          <li>
        <a href="historico.html">
                <i class="fa fa-circle"></i>
                    <span>Historico</span>
                      </a>
                    </li>
                    <li>
                  <li>
            <a href="sensores.html">
              <i class="fa fa-circle"></i>
              <span>Sensores</span>
            </a>
          </li>
          <li>
            <a href="alertas.html">
              <i class="fa fa-circle"></i>
              <span>Alertas</span>
            </a>
          </li>
        </ul>
        <!-- /.sidebar-menu -->
      </section>
      <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->
      <section class="content-header">
        <h1 style="margin-left:1px">
          Status Atual
        </h1>
        <ol class="breadcrumb">
          <li><a href="index.html"><i class="fa fa-home"></i> Home</a></li>
        </ol>
      </section>

      <!-- Main content -->
      
        <div class="col-md-3 col-sm-6 col-xs-12" >
          <div class="info-box">
            <span class="info-box-icon bg-orange"><i class="fa fa-fw  ion-thermometer"></i></span>

            <div class="info-box-content">
              <span class="info-box-text">Temp. Atual</span>
              <span id="tem" class="info-box-number">22.5<small> Cº</small></span>
              <span  style="color:green; font-size: 15px">Situação Normal</span>
              <img src="/dist/img/c.jpg" style="max-width:15px">

            </div>
            <!-- /.info-box-content -->
          </div>
          <!-- /.info-box -->
        </div>

        <!--2 campo -->
        
        <div class="col-md-3 col-sm-6 col-xs-12" style="margin-left: -14px" >
          <div class="info-box">
            <span class="info-box-icon bg-blue"><i class="fa fa-fw ion-cloud"></i></span>

            <div class="info-box-content">
              <span class="info-box-text">Umidade Atual</span>
              <span id="umi" class="info-box-number">75<small>%</small></span>
              <span  style="color:green; font-size: 15px">Situação Normal</span>
              <img src="/dist/img/c.jpg" style="max-width:15px">

            </div>

          <!--Inicio dos novos campos-->

            <!-- /.info-box-content -->
          </div>
        </div>
          <!-- /.info-box -->
        <div class="box-footer" style=" width: 515px; max-height:90px; margin-left:545px;" >

          <img src="/dist/img/barra.png" style="max-height: 60px; margin-left: -375px; margin-top: 4px;">

              <div class="col-sm-3 col-xs-6">
                <div class="description-block border-right">
                  <span style="font-size:20px;" class="description-percentage text-green "><i class="fa fa-caret-down"></i> 17 Cº</span>
                </br>
          
                  <span  class="description-text">Temp Min.</span>
                </div>
                
                <!-- /.description-block -->
              </div>


              <img src="/dist/img/barra.png" style="max-height: 60px; margin-left: 120px; margin-top: 4px;">

              

              <div class="col-sm-3 col-xs-6 ">
                <div class="description-block border-right">
                  <span style="font-size:20px;" class="description-percentage text-red"><i class="fa fa-caret-up"></i> 26 Cº</span>
                </br>
          
                  <span  class="description-text  ">Temp Max.</span>
                </div>
              </div>

              <img src="/dist/img/barra.png" style="max-height: 60px; margin-left: 115px; margin-top: 4px;">


              <div class="col-sm-3 col-xs-6 ">
                <div class="description-block border-right">
                  <span style="font-size:20px;" class="description-percentage text-green"><i class="fa fa-caret-down"></i> 65.5 %</span>
                </br>
          
                  <span  class="description-text  ">Umid Min.</span>
                </div>
              </div>

              <div class="col-sm-3 col-xs-6 ">
                <div class="description-block border-right">
                  <span style="font-size:20px;" class="description-percentage text-red"><i class="fa fa-caret-up"></i> 90.5 %</span>
                </br>
          
                  <span  class="description-text  ">Umid Max.</span>
                </div>
              </div>

              


            
          <!--Final dos novos campos-->
        </div>
     
        
       

      <div id="container" style="min-width: 310px;max-width: 1045px; height: 450px; margin:15px ;margin-top:30px ;"></div>

      
      <input type="hidden" data-start="<%=JSON.stringify(start)%>" id="rs">


      <!-- /.content -->
    
    <!-- /.content-wrapper -->

    



     <!-- jQuery 3 -->

    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="/socket.io/socket.io.js"></script>

  <script>
    //console.log(rs);
    var socket = io('http://localhost:3000');
    
    var start = document.querySelector('#rs');

    var json = JSON.parse(start.dataset.start);
    console.log(json.temp[0]);
    

      Highcharts.chart('container', {
        chart: {
            type: 'line',
            events: {
  
              load: function () {


                var series = this.series[0];
                var seriesz = this.series[1];
                var cat = this.xAxis[0].categories;
                console.log(typeof cat)
                 var t=80;
                  var u=26;
                socket.on('replay',function(time,temp,umid){
                  
                  
                  console.log('ok');
                  console.log(time);
                  var date = new Date();
                  var time =`${date.getHours()-3}:0${date.getMinutes()}:${date.getSeconds()}`
                 

                  t = t + 0.5
                  u = u + 0.5;

                  time = (new Date()).getTime()
                  var g= time + 1 * 1000

                  document.querySelector("#tem").innerHTML=temp+" Cº";
                  document.querySelector("#umi").innerHTML=umid+" %";

                  series.addPoint([time, umid], true, true);
                  seriesz.addPoint([time, temp], true, true);




                });



  
            //    var tem = document.querySelector('#tem');
              //  var umi = document.querySelector('#umi');
               /* 
                var g =25;
                console.log(new Date().getTime());    
                  // set up the updating of the chart each second
                  var series = this.series[0];
                  setInterval(function () {
                   // tem.innerHTML = g+0.5;
                      var x = (new Date()).getTime(), // current time
                          y = g = g+0.5
                      series.addPoint([x, y], true, true);
                  }, 10000);
  
                  var l =75;
                  // set up the updating of the chart each second
                  var seriesz = this.series[1];
                  
                  setInterval(function () {
                   // umi.innerHTML =l+0.5;
                      var x = (new Date()).getTime(), // current time
                          y = l = l+0.5;
                      seriesz.addPoint([x, y], true, true);
                  }, 10000);
  */
                
                  
              }
          }
        },
        time: {
          useUTC: false
        },
        title: {
            text: 'Farmacia-Haddok Lobo'
        },
        subtitle: {
            text: 'Geladeira piso Superior'
        },
        xAxis: {
          type: 'datetime',
          tickPixelInterval:200,
         // categories: json.time
        },
        yAxis: {
            title: {
                text: 'Temperatura (°C)    Umidade %'
            }
        },
        plotOptions: {
            line: {
                dataLabels: {
                    enabled: true
                },
                enableMouseTracking: true
            }
        },
        series: [{
          name: 'Umidade',
  
          data:(function () {
            // generate an array of random data
            var data = [],
                time = (new Date()).getTime(),
                i;
              var c =0
            for (i = -9; i <= 0; i += 1) {
                data.push({
                    x: time + i *4000,
                    y: json.umid[c]
                });
                c++;
            }
            return data;
        }())
        },{
          name: 'Temperatura',
  
          data: (function () {
            // generate an array of random data
            var data = [],
                time = (new Date()).getTime(),i;
                c = 0;

            for (i = -9; i <= 0; i += 1) {
              
                data.push({
                    x: time + i * 4000,
                    y: json.temp[c]
                });
                 c++
            }
            return data;
        }())
        }
         
        ]
      });




                
  
    
  </script>

 <!-- jQuery 3 -->
 <script src="bower_components/jquery/dist/jquery.min.js"></script>
 <!-- Bootstrap 3.3.7 -->
 <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
 <!-- PACE -->
 <script src="bower_components/PACE/pace.min.js"></script>
 <!-- SlimScroll -->
 <script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
 <!-- FastClick -->
 <script src="bower_components/fastclick/lib/fastclick.js"></script>
 <!-- AdminLTE App -->
 <script src="dist/js/adminlte.min.js"></script>
 <!-- AdminLTE for demo purposes -->
 <script src="dist/js/demo.js"></script>
 <!-- page script -->
 <script type="text/javascript">
   // To make Pace works on Ajax calls
   $(document).ajaxStart(function () {
     Pace.restart()
   })
   $('.ajax').click(function () {
     $.ajax({
       url: '#', success: function (result) {
         $('.ajax-content').html('<hr>Ajax Request Completed !')
       }
     })
   })
 </script>






  
</html>